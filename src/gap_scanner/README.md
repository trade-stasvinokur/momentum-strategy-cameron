# Gap¬†Scanner¬†API ‚Äì REST‚Äë—Å–µ—Ä–≤–∏—Å –Ω–∞ FastAPI –¥–ª—è –ø–æ–∏—Å–∫–∞ —É—Ç—Ä–µ–Ω–Ω–∏—Ö ¬´–≥—ç–ø–æ–≤¬ª

**Gap¬†Scanner¬†API**¬†‚Äî —ç—Ç–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –Ω–∞ FastAPI, –∫–æ—Ç–æ—Ä—ã–π —Å–∫–∞–Ω–∏—Ä—É–µ—Ç —Ä–æ—Å—Å–∏–π—Å–∫–∏–π —Ä—ã–Ω–æ–∫ –∞–∫—Ü–∏–π —á–µ—Ä–µ–∑ Tinkoff¬†Invest¬†API –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –±—É–º–∞–≥–∏, –æ—Ç–∫—Ä—ã–≤—à–∏–µ—Å—è —Å —Ä–∞–∑—Ä—ã–≤–æ–º (gap‚Äëup) –Ω–µ –º–µ–Ω—å—à–µ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –ø–æ—Ä–æ–≥–∞.

---

## ‚öôÔ∏è –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ **Python¬†‚â•‚ÄØ3.13**.
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª¬†`.env.example` ‚Üí¬†`.env` –∏ –≤–ø–∏—à–∏—Ç–µ:
   ```dotenv
   TINKOFF_INVEST_TOKEN=–í–ê–®_–¢–û–ö–ï–ù
   ```
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
   ```bash
   pip install fastapi "uvicorn[standard]" tinkoff-invest python-dotenv
   # –∏–ª–∏ —á–µ—Ä–µ–∑ uv
   # pip install uv && uv pip install fastapi "uvicorn[standard]" tinkoff-invest python-dotenv
   ```

### 2. –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ

```bash
uvicorn gap_scanner.gap_scanner:app --reload
```

–°–µ—Ä–≤–µ—Ä –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –Ω–∞¬†`http://127.0.0.1:8000/`.

* Swagger‚Äë–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: `http://127.0.0.1:8000/docs`
* ReDoc:¬†`http://127.0.0.1:8000/redoc`

### 3. –ó–∞–ø—É—Å–∫ –≤¬†Docker

```bash
docker compose up --build
```

–§–∞–π–ª `docker-compose.yml` —É–∂–µ –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ—Ç –ø–æ—Ä—Ç¬†8000 –Ω–∞—Ä—É–∂—É, —Ç–∞–∫ —á—Ç–æ API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ `http://localhost:8000/`.

---

## üõ†Ô∏è API Reference

### `GET /gap-up`

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|-----------------------|-----------|
| `min_gap` | float | `0.10` | –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —É—Ç—Ä–µ–Ω–Ω–∏–π gap (0.10‚ÄØ=‚ÄØ10‚ÄØ%) |
| `date` | `YYYY-MM-DD` | —Å–µ–≥–æ–¥–Ω—è (UTC) | –î–∞—Ç–∞ —Ç–æ—Ä–≥–æ–≤ |

#### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞

```bash
curl "http://localhost:8000/gap-up?min_gap=0.12&date=2025-07-27"
```

#### –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞

```json
{
  "count": 1,
  "results": [
    {
      "ticker": "CHMK",
      "figi": "BBG000RP8V70",
      "uid": "b5e26096-d013-48e4-b2a9-2f38b6090feb",
      "prev_close": 4880.0,
      "open": 4990.0,
      "gap": 0.0225,
      "gap_test": true
    }
  ]
}
```

* –ü–æ–ª–µ `gap_test` = `true`, –µ—Å–ª–∏ –Ω–∏–∫–∞–∫–∏—Ö –±—É–º–∞–≥ —Å —Ä–µ–∞–ª—å–Ω—ã–º –≥—ç–ø–æ–º ‚â•¬†`min_gap` –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –∏ –≤ –æ—Ç–≤–µ—Ç –ø–æ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –∞–∫—Ü–∏—è —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º —Ä–∞–∑—Ä—ã–≤–æ–º –¥–ª—è back‚Äëtest‚Äë–∞–Ω–∞–ª–∏–∑–∞.

---

## üì¶ Docker‚Äë–æ–±—Ä–∞–∑

–°–æ–±–∏—Ä–∞–µ—Ç—Å—è –∏–∑ `src/gap_scanner/Dockerfile` (Python¬†slim¬†3.13). –û—Å–Ω–æ–≤–Ω—ã–µ —à–∞–≥–∏:

1. –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤ –≤¬†`/app`.
2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.
3. –≠–∫—Å–ø–æ—Ä—Ç –ø–æ—Ä—Ç–∞¬†8000.
4. –ó–∞–ø—É—Å–∫ `uvicorn gap_scanner.gap_scanner:app`