## ABCD¬†Pattern¬†‚Äì –≤–Ω—É—Ç—Ä–∏–¥–Ω–µ–≤–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è ¬´ABCD¬ª

**ABCD‚ÄØPattern** ‚Äî –ª—ë–≥–∫–∏–π HTTP‚Äë—Å–µ—Ä–≤–∏—Å (FastAPI), –∫–æ—Ç–æ—Ä—ã–π *–¥–ª—è –∑–∞–¥–∞–Ω–Ω–æ–≥–æ —Ç–∏–∫–µ—Ä–∞ –∏ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –¥–Ω—è* –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–ª—Å—è‚ÄØ–ª–∏ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Ä–∞–∑–≤–æ—Ä–æ—Ç–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω **A‚ÄëB‚ÄëC‚ÄëD** –Ω–∞ —Ç–∞–π–º‚Äë—Ñ—Ä–µ–π–º–∞—Ö 1‚ÄØ–º–∏–Ω –∏‚ÄØ5‚ÄØ–º–∏–Ω, –∫–∞–∫ –µ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Ross‚ÄØCameron –≤ momentum‚Äë—Ç—Ä–µ–π–¥–∏–Ω–≥–µ.

1. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –ø–æ–ª–Ω—ã–µ –¥–Ω–µ–≤–Ω—ã–µ —Å–≤–µ—á–∏ —á–µ—Ä–µ–∑ Tinkoff‚ÄØInvest¬†API: `CANDLE_INTERVAL_1_MIN` –∏ `CANDLE_INTERVAL_5_MIN`.
2. –ü–µ—Ä–µ–±–∏—Ä–∞–µ—Ç —Å–≤–µ—á–∏, –Ω–∞—Ö–æ–¥—è –ª–æ–∫–∞–ª—å–Ω—ã–π –º–∞–∫—Å–∏–º—É–º *B* –∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏–π –æ—Ç–∫–∞—Ç *C*.
3. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ –∏–∑ –∫–ª–∞—Å—Å–∏–∫–∏ –≥–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–∏—Ö —Ñ–∏–≥—É—Ä:

   * –æ—Ç–∫–∞—Ç 20‚Äë80‚ÄØ% –≤—ã—Å–æ—Ç—ã –∏–º–ø—É–ª—å—Å–∞ *A‚ÄØ‚Üí‚ÄØB*;
   * –æ–±—ä—ë–º –≤–æ –≤—Ä–µ–º—è –æ—Ç–∫–∞—Ç–∞ –ø–∞–¥–∞–µ—Ç, –Ω–∞ –ø—Ä–æ–±–æ–µ *D* ‚Äî —Ä–∞—Å—Ç—ë—Ç ‚â•‚ÄØ2√ó —Å—Ä–µ–¥–Ω–µ–≥–æ –æ—Ç–∫–∞—Ç–Ω–æ–≥–æ;
   * –º–∏–Ω–∏–º—É–º –æ—Ç–∫–∞—Ç–∞ –≤—ã—à–µ —Ç–æ—á–∫–∏ *A* (—Ç—Ä–µ–Ω–¥ –æ—Å—Ç–∞—ë—Ç—Å—è –±—ã—á—å–∏–º).
4. –ï—Å–ª–∏ —É—Å–ª–æ–≤–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã, —Å–µ—Ä–≤–∏—Å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `entry_price`, `stop_price`, `target_price`, `trigger_time`.

–ì–æ—Ç–æ–≤ –∫ Docker‚Äë—Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—é –∏–ª–∏ –≤—ã–∑–æ–≤—É –Ω–∞–ø—Ä—è–º—É—é –∏–∑ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞.

---

## ‚öôÔ∏è –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

1. **Python‚ÄØ‚â•‚ÄØ3.13**.
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` ‚Üí `.env` –∏ –∑–∞–¥–∞–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

```dotenv
# –¢–æ–∫–µ–Ω Tinkoff Invest API
TINKOFF_INVEST_TOKEN=your_token_here
# –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å (–¥–ª—è –ª–æ–≥–æ–≤)
TZ=Europe/Moscow
# –ü–æ—Ä—Ç, –∫–æ—Ç–æ—Ä—ã–π —Å–ª—É—à–∞–µ—Ç —Å–µ—Ä–≤–∏—Å
PORT=8006
```

3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
pip install uv
```

### 2. –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ

```bash
uv run uvicorn abcd:app --host 0.0.0.0 --port 8006
```

`uvicorn` ‚Äî —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π ASGI‚Äë—Å–µ—Ä–≤–µ—Ä –¥–ª—è FastAPI.

–ü—Ä–æ–≤–µ—Ä–∫–∞:

```bash
curl -s "http://localhost:8006/abcd?ticker=SBER&uid=f0eac4d5-4753-4c05-857e-676f25c18e68&date=2025-07-28"
```

–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:

```json
{
  "ticker": "SBER",
  "date": "2025-07-28",
  "abcd_1min": {
    "triggered": true,
    "entry_price": 282.15,
    "stop_price": 279.70,
    "target_price": 288.60,
    "trigger_time": "2025-07-28T08:44:00+00:00"
  },
  "abcd_5min": {
    "triggered": false,
    "entry_price": null,
    "stop_price": null,
    "target_price": null,
    "trigger_time": null
  }
}
```

### 3. –ó–∞–ø—É—Å–∫ –≤ Docker

```bash
docker compose up abcd
```

`docker-compose.yml` —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–µ—Ä–≤–∏—Å **abcd** —Å –ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π –ø–æ—Ä—Ç–∞¬†`8006`.

---

## üß∞ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è             | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é    | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                                   |
| ---------------------- | ----------- | --------------- | ------------------------------------------------------------ |
| `TINKOFF_INVEST_TOKEN` | –¥–∞          | ‚Äî               | –î–æ—Å—Ç—É–ø –∫¬†Market‚ÄØData¬†API¬†Tinkoff                             |
| `TZ`                   | –Ω–µ—Ç         | `Europe/Moscow` | –õ–æ–∫–∞–ª—å–Ω–∞—è —Ç–∞–π–∑–æ–Ω–∞ –¥–ª—è –ª–æ–≥–æ–≤¬†                                 |
| `PORT`                 | –Ω–µ—Ç         | `8006`          | –ü–æ—Ä—Ç, –Ω–∞¬†–∫–æ—Ç–æ—Ä–æ–º —Å–ª—É—à–∞–µ—Ç FastAPI                             |

---

## üîÑ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –ö–ª–∏–µ–Ω—Ç –¥–µ–ª–∞–µ—Ç **GET** `/abcd?ticker&uid&date`.
2. –°–µ—Ä–≤–∏—Å –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–π –¥–µ–Ω—å —Å–≤–µ—á–µ–π:

   * `CANDLE_INTERVAL_1_MIN`;
   * `CANDLE_INTERVAL_5_MIN`.
3. –ê–ª–≥–æ—Ä–∏—Ç–º ABCD:

   1. –ü—Ä–æ—Ö–æ–¥–∏—Ç –º–∞—Å—Å–∏–≤ —Å–≤–µ—á–µ–π, –Ω–∞—Ö–æ–¥—è –ª–æ–∫–∞–ª—å–Ω—ã–π –ø–∏–∫ *B* (—É—Å–ª–æ–≤–∏–µ: —Ö–∞–π –≤—ã—à–µ —Å–æ—Å–µ–¥–Ω–∏—Ö).
   2. –û—Ç–º–µ—á–∞–µ—Ç –æ—Ç–∫–∞—Ç: –¥–≤–µ –∏ –±–æ–ª–µ–µ —Å–≤–µ—á–∏ —Å –ø–æ–Ω–∏–∂–∞—é—â–∏–º–∏—Å—è —Ö–∞–π.
   3. –ù–∞—Ö–æ–¥–∏—Ç –º–∏–Ω–∏–º—É–º –æ—Ç–∫–∞—Ç–∞ *C* –∏ –ø–µ—Ä–≤—É—é —Å–≤–µ—á—É, –ø—Ä–µ–≤—ã—à–∞—é—â—É—é —Ö–∞–π *B* ‚Äî —Ç–æ—á–∫—É *D*.
   4. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç:

      * –æ—Ç–∫–∞—Ç 20‚Äë80‚ÄØ% –∏–º–ø—É–ª—å—Å–∞ *A‚ÄØ‚Üí‚ÄØB*;
      * –æ–±—ä—ë–º –≤ –æ—Ç–∫–∞—Ç–µ < –æ–±—ä—ë–º–∞ –∏–º–ø—É–ª—å—Å–∞; –æ–±—ä—ë–º –Ω–∞ *D* ‚â•‚ÄØ2√ó —Å—Ä–µ–¥–Ω–µ–≥–æ –æ—Ç–∫–∞—Ç–Ω–æ–≥–æ;
      * –º–∏–Ω–∏–º—É–º –æ—Ç–∫–∞—Ç–∞ –≤—ã—à–µ *A*.
   5. –ü—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏:

      * `entry_price`¬†= —Ü–µ–Ω–∞ *B*;
      * `stop_price`¬†= –º–∏–Ω–∏–º—É–º *C*;
      * `target_price`¬†= *B*‚ÄØ+‚ÄØ( *B*‚ÄØ‚àí‚ÄØ*A* );
      * `trigger_time`¬†= –≤—Ä–µ–º—è —Å–≤–µ—á–∏ *D*.
4. –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ Pydantic –º–æ–¥–µ–ª–µ–π `ABCDResult` –∏ `ABCDResponse`.
5. CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ `'*'` —á–µ—Ä–µ–∑ `CORSMiddleware` –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏.
6. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (`INFO`) ‚Äî –∫–ª—é—á–µ–≤—ã–µ —ç—Ç–∞–ø—ã –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã; –æ—à–∏–±–∫–∏ Market‚ÄØData¬†API ‚Äî `ERROR`.

---

## üóÑÔ∏è –õ–æ–≥–∏ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

–ü–æ¬†—É–º–æ–ª—á–∞–Ω–∏—é —Å–µ—Ä–≤–∏—Å –ø–∏—à–µ—Ç –≤¬†stdout ‚Üí `docker logs abcd`. –î–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –æ—Ç–ª–∞–¥–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ `uvicorn` —Å `--log-level debug`, —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å –≤—Å–µ –ø—Ä–∏—à–µ–¥—à–∏–µ —Å–≤–µ—á–∏.

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
abcd/
‚î£ abcd.py                # FastAPI‚Äë–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –ª–æ–≥–∏–∫–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ ABCD
‚î£ DockerfileABCD         # python:3.13‚Äëslim, ENTRYPOINT ["uv", "run", "uvicorn ..."]
‚îó README_Abcd.md         # —ç—Ç–æ—Ç —Ñ–∞–π–ª
```

---

### ‚ú® –ì–æ—Ç–æ–≤–æ

–ü–æ—Å–ª–µ `docker compose up` –æ–∫—Ä—É–∂–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç:

* **abcd** ‚Äî REST¬†API —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ ABCD
* (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) **orchestrator** ‚Äî –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –ø–æ¬†—Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é –≤—ã–∑—ã–≤–∞–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.

–ü–æ–¥–∫–ª—é—á–∞–π—Ç–µ —Å–µ—Ä–≤–∏—Å –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ cURL/Postman –∏–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç –≤ —Å–≤–æ–∏ —Ç—Ä–µ–π–¥–∏–Ω–≥‚Äë—Å–∫—Ä–∏–ø—Ç—ã.